Проект Excel 80s

Это - финальный проект нашего курса. Его уровень сложности я отношу к «сложнейший». Его цель - дать постоянную пищу для размышлений и постоянную практику. Вполне возможно, вы реализуете его часть, а затем захотите начать заново - это нормально. Не все вещи создаются с первого раза.

Общая постановка задачи
Необходимо будет реализовать Excel в командной строке. Программа получает файл (в формате json или yaml) с таблицей. Формат файла можно выбрать самому. В таблице хранятся два типа данных: значения и формулы. Все как в Excel.

Минимальная реализация
В минимуме, вы передаете программе файл с таблицей и вычисляете формулы. Программа читает файл с формулами и значениями, а на выходе печатает только таблицу. Если в ячейке формула, она должна быть заменена числом.

Как распечатать таблицу
Воспользуйтесь библиотеками Python. Свою реализацию делать не нужно. Лучше воспользоваться Rich, он позволяет печатать и таблицы, и обновлять экран. Кстати, библиотека Rich крайне популярна, это не нишевый продукт.

Максимальная реализация
Подумайте над тем, чтобы можно было вводить данные и формулы в ячейки во время выполнения программы. Например, на экране (прямо в терминале!) отображена таблица и приглашение к вводу (как при функции input()). Вводим данные в формате «A1 = 10» или «B10:C40 = 15» или «C7 = A1 + СУММ(B2:D8)» и таблица на экране обновляется. Rich позволяет обновлять содержимое терминала, т.е. после ввода не создается еще одна таблица, а на экране будет показана новая.

Поддерживаемые формулы
- Необходимо, чтобы программа поддерживала следующие формулы: арифметические операции (плюс, минус, умножить, поделить, возведение в степень) и скобки любой вложенности;
- Функции СУММ, АБС, СУММЕСЛИ, ЕСЛИ. Аргументами функций могут быть числа, ячейки, диапазоны. Пример: СУММ(1; A1:B2; 3; A1 + C8). Аргументы разделяются через точку с запятой. Порядок и смысл аргументов как в Excel.
- Подумайте над тем, чтобы иметь возможность добавлять новые функции быстро. Хорошая программа должна иметь потенциал для улучшения.
- Сделать обработку ошибок: если число делится на ноль, то программа не вылетает, а пишет в ячейке «дел 0». Если диапазон не существует, неправильный аргумент или их недостаточное число аргументов, то выводим в соответствующей ячейке «ОШИБКА такая-то»

Рекомендуемый подход:
Я бы использовал ООП, но вы можете писать и процедуры/функции.
Настоятельно рекомендую писать тесты, огромное число тестов. В противном случае, вносить изменения в код будет проблематично. Модули, объединенные единым смыслом, складывайте в пакеты.# Excel_80s
